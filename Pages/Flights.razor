@page "/flights"
@using Assignment2.Models;

<div class="d-flex flex-row justify-content-evenly">

	<div class="d-flex flex-column">
		<h3>Flights</h3>
			<div class="flights-list">
				<p>@flightMessage</p>
			</div>
	</div>

	<div class="d-flex flex-column align-items-center">
		<h3>Reserve</h3>
		<form class="d-flex flex-column align-items-end">
			<div class="form-group d-flex flex-row align-items-center">
				<label for="flight">Flight: </label> &nbsp
				<input type="text" class="form-control" id="inputFlight" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="airline">Airline: </label> &nbsp
				<input type="text" class="form-control" id="inputAirline" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="day">Day: </label> &nbsp
				<input type="text" class="form-control" id="inputDay" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="time">Time: </label> &nbsp
				<input type="text" class="form-control" id="inputTime" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="cost">Cost: </label> &nbsp
				<input type="text" class="form-control" id="inputCost" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="name">Name: </label> &nbsp
				<input type="text" class="form-control" id="inputName" />
			</div>
			<div class="form-group d-flex flex-row align-items-center">
				<label for="citizenship">Citizenship: </label> &nbsp
				<input type="text" class="form-control" id="inputCitizenship" />
			</div>
		</form>
		<button type="button" class="btn btn-primary mt-3">Reserve</button>
		<p>from: @originAirportCode</p>
		<p>to: @destinationAirportCode</p>

	</div>

</div>


<div class="d-flex flex-column align-items-center justify-content-center mt-4">
	<h3>Flight Finder</h3>
	<div class="d-flex flex-column align-items-end">
		<div class="d-flex flex-row align-items-center justify-content-center mb-2">
			<div>From: </div> &nbsp;
			<select @onchange="SelectOriginAirport" bind="@originAirportCode" class="form-select" style="min-width:400px;">
				@foreach (var airport in airports)
				{
					<option>@airport.AirportCode</option>
				}
			</select>
		</div>
		<div class="d-flex flex-row align-items-center justify-content-center mb-2">
			<div>To: </div> &nbsp;
			<select @onchange="SelectDestinationAirport" bind="@destinationAirportCode" class="form-select" style="min-width:400px;">
				@foreach (var airport in airports)
				{
					<option>@airport.AirportCode</option>
				}
			</select>
		</div>
		<div class="d-flex flex-row align-items-center justify-content-center mb-2">
			<div>Day: </div> &nbsp;
			<select @onchange="SelectDay" bind="@dayValue" class="form-select" style="min-width:400px;">
				@foreach (var day in days)
				{
					<option value="@day">@day</option>
				}
			</select>
		</div>
	</div>
	<button @onclick="FindFlights" type="button" class="btn btn-primary mt-3" mb-3>Find flights</button>
</div>

@code {

	AirportManager am = new AirportManager();
	List<Airport> airports = AirportManager.GetAirports();

	string originAirportCode = "YYC"; // Default value on loadup
	string destinationAirportCode = "YYC"; // Default value on loadup

	FlightManager fm = new FlightManager();
	List<Flight> flights = FlightManager.GetFlights();
	List<string> days = FlightManager.GetDays();

	string flightMessage;
	string dayValue = "Any"; // Default value on loadup

	private void SelectOriginAirport(ChangeEventArgs e)
	{
		originAirportCode = e.Value.ToString();
	}

	private void SelectDestinationAirport(ChangeEventArgs e)
	{
		destinationAirportCode = e.Value.ToString();
	}

	private string GetFlights()
	{
		return flightMessage;
	}

	private void FindFlights()
	{
		/*var filteredOriginList = flights.Where(x => x.OriginAirport == originAirportCode).ToList();
		var filteredDestinationList = flights.Where(x => x.DestinationAirport == destinationAirportCode).ToList();
		var filteredDayList = flights.Where(x => x.Day == dayValue).ToList();*/
		flightMessage = ""; // Reset the list so it doesn't keep infinitely adding
		foreach (var flight in flights)
		{
				flightMessage += flight.ToString();
		}
		GetFlights();
	}
	private void SelectDay(ChangeEventArgs e)
	{
		dayValue = e.Value.ToString();
	}
}